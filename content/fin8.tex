\section{Finding 8 - Root Read Access via Port 443}
%center under chapter title a one row table with 6 coloumns and no borders
\vspace*{-0,3cm}
\begin{center}
    \begin{tabular}{c c c c}
        \textbf{Classification:} & Misconfiguration & \textbf{Severity:} & \textbf{\textcolor{red}{High}}  
        \end{tabular}
\end{center}

On port 443 of the \ac{DUT} a webserver is running. Trying to access this webserver with an internet browser results in an error page. The following error message is shown:
\begin{lstlisting}[language=bash]
Error opening ''
548660451168:error:02001002:system library:fopen:
No such file or directory:bss_file.c:169:fopen('','r')
548660451168:error:2006D080:BIO routines:BIO_new_file:
no such file:bss_file.c:172:
\end{lstlisting}
This indicates that the webserver is trying to open a file but the filename is not found.


\subsection*{Finding Impact}
While trying to use path traversal on the webserver it was found that the filename isn't missing but using the path appended to the URL. This can be exploited to access files on the \ac{DUT} which are not intended to be accessed by the user. By changing the path for example the shadow file can be accessed. This could be used to gain access to the \ac{DUT} by hashcracking the passwords. Also other exploits could be possible.

\subsection*{Finding Details}
Following image shows the error shown by the webserver when trying to access the webserver without a filename:
\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{img/port443_error.png}
    \caption{Error when accessing webserver without filename}
    \label{fig:fin8-1}
\end{figure}
After changing the url-path also the error message changes:
\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{img/port443_error_detailed.png}
    \caption{Error when accessing webserver with filename}
    \label{fig:fin8-2}
\end{figure}
That leads to the conclusion that the webserver is trying to open a file with the path appended to the URL. This can be used to access files on the \ac{DUT} which are not intended to be accessed by the user. The following image shows the access to the shadow file:
\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{img/shadow-file-433.png}
    \caption{Access to shadow file}
    \label{fig:fin8}
\end{figure}


\subsection*{Evaluation of Results}
\begin{center}
    \begin{tabular}{cccc}
    \textbf{Effort to Fix:} & &\ \textbf{\textcolor{green!50!blue}{Low}}\
    \end{tabular}
\end{center}
Fix the file which sets the filename that should be opened. This should prevent the webserver from opening files which are not intended to be opened. Also whitelisting the allowed paths could be a solution to prevent path traversal.
